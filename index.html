<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Manager | TOPLINK SOLUTIONS, BENICK ACCESSORIES, KIM MELONS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        .sidebar-link.active {
            background-color: #3b82f6;
            color: white;
        }
        .sidebar-link:hover:not(.active) {
            background-color: #f3f4f6;
        }
        .fade-in {
            animation: fadeIn 0.5s;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .card-hover {
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .auth-form {
            transition: all 0.3s ease-in-out;
        }
        .hidden-form {
            display: none;
            opacity: 0;
            transform: translateX(20px);
        }
        .active-form {
            display: block;
            opacity: 1;
            transform: translateX(0);
        }
        .modal {
            transition: all 0.3s ease-in-out;
        }
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Login Screen -->
    <div id="login-screen" class="min-h-screen flex items-center justify-center bg-gradient-to-r from-blue-500 to-purple-600 p-4">
        <div class="bg-white p-8 rounded-2xl shadow-2xl w-full max-w-md relative overflow-hidden">
            <!-- Loading Spinner -->
            <div id="loading-spinner" class="hidden absolute inset-0 bg-white bg-opacity-90 flex items-center justify-center z-10">
                <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"></div>
            </div>

            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-gray-800">Business Manager</h1>
                <p class="text-gray-600 mt-2">Manage TOPLINK, BENICK & KIM MELONS</p>
            </div>

            <!-- Toggle Buttons -->
            <div class="flex mb-6 bg-gray-100 rounded-lg p-1">
                <button id="login-tab" class="flex-1 py-2 px-4 rounded-md font-medium transition-colors bg-blue-500 text-white">
                    Login
                </button>
                <button id="signup-tab" class="flex-1 py-2 px-4 rounded-md font-medium transition-colors text-gray-600 hover:text-gray-800">
                    Sign Up
                </button>
            </div>

            <!-- Login Form -->
            <form id="login-form" class="auth-form active-form">
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="login-email">
                        Email
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" 
                           id="login-email" type="email" placeholder="your@email.com" required>
                </div>
                <div class="mb-6">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="login-password">
                        Password
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline" 
                           id="login-password" type="password" placeholder="Password" required>
                </div>
                <div class="flex items-center justify-between mb-4">
                    <a href="#" id="forgot-password-link" class="text-sm text-blue-500 hover:text-blue-700">
                        Forgot Password?
                    </a>
                </div>
                <div class="flex items-center justify-between">
                    <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline w-full" type="submit">
                        Sign In
                    </button>
                </div>
            </form>

            <!-- Sign Up Form -->
            <form id="signup-form" class="auth-form hidden-form">
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="signup-name">
                        Full Name
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" 
                           id="signup-name" type="text" placeholder="Your Name" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="signup-email">
                        Email
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" 
                           id="signup-email" type="email" placeholder="your@email.com" required>
                </div>
                <div class="mb-6">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="signup-password">
                        Password
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline" 
                           id="signup-password" type="password" placeholder="Create a password" minlength="6" required>
                </div>
                <div class="flex items-center justify-between">
                    <button class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline w-full" type="submit">
                        Create Account
                    </button>
                </div>
            </form>

            <!-- Forgot Password Form -->
            <form id="forgot-password-form" class="auth-form hidden-form">
                <div class="mb-6">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="reset-email">
                        Email Address
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" 
                           id="reset-email" type="email" placeholder="your@email.com" required>
                    <p class="text-sm text-gray-600 mt-2">We'll send you a password reset link</p>
                </div>
                <div class="flex items-center justify-between space-x-4">
                    <button type="button" id="back-to-login" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline flex-1">
                        Back
                    </button>
                    <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline flex-1" type="submit">
                        Send Reset Link
                    </button>
                </div>
            </form>

            <!-- Messages -->
            <div id="auth-message" class="mt-4 p-3 rounded hidden"></div>

            <div class="mt-6 text-center text-sm text-gray-600">
                <p>Demo: Use demo@example.com / password123 to login</p>
            </div>
        </div>
    </div>

    <!-- Main App (initially hidden) -->
    <div id="app" class="hidden">
        <!-- Add Record Modal -->
        <div id="add-record-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
                <h3 class="text-xl font-bold mb-4">Add New Record</h3>
                <form id="record-form">
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Business</label>
                        <select class="w-full p-2 border rounded" id="record-business">
                            <option value="toplink">TOPLINK SOLUTIONS</option>
                            <option value="benick">BENICK ACCESSORIES</option>
                            <option value="kim">KIM MELONS</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Type</label>
                        <select class="w-full p-2 border rounded" id="record-type">
                            <option value="income">Income</option>
                            <option value="expense">Expense</option>
                            <option value="supplier">Supplier Payment</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Amount</label>
                        <input type="number" class="w-full p-2 border rounded" id="record-amount" placeholder="0.00" step="0.01">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Description</label>
                        <textarea class="w-full p-2 border rounded" id="record-description" rows="3" placeholder="Enter description"></textarea>
                    </div>
                    <div class="flex justify-end space-x-3">
                        <button type="button" id="cancel-record" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded">Cancel</button>
                        <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded">Save Record</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Add Supplier Modal -->
        <div id="add-supplier-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
                <h3 class="text-xl font-bold mb-4">Add New Supplier</h3>
                <form id="supplier-form">
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Business</label>
                        <select class="w-full p-2 border rounded" id="supplier-business">
                            <option value="toplink">TOPLINK SOLUTIONS</option>
                            <option value="benick">BENICK ACCESSORIES</option>
                            <option value="kim">KIM MELONS</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Supplier Name</label>
                        <input type="text" class="w-full p-2 border rounded" id="supplier-name" placeholder="Enter supplier name">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Contact Email</label>
                        <input type="email" class="w-full p-2 border rounded" id="supplier-email" placeholder="supplier@email.com">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2">Phone</label>
                        <input type="tel" class="w-full p-2 border rounded" id="supplier-phone" placeholder="+1-555-0123">
                    </div>
                    <div class="flex justify-end space-x-3">
                        <button type="button" id="cancel-supplier" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded">Cancel</button>
                        <button type="submit" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded">Add Supplier</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="fixed top-0 left-0 h-full w-64 bg-white shadow-lg z-10">
            <div class="p-4 border-b">
                <h1 class="text-xl font-bold text-gray-800">Business Manager</h1>
                <p class="text-sm text-gray-600" id="user-welcome">Welcome back!</p>
            </div>
            <div class="p-4">
                <h2 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2">Dashboard</h2>
                <ul>
                    <li>
                        <a href="#" class="sidebar-link active block py-2 px-4 rounded mb-1 text-gray-700" data-page="main-dashboard">
                            <i class="fas fa-tachometer-alt mr-2"></i>Overall Dashboard
                        </a>
                    </li>
                </ul>
                
                <h2 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mt-6 mb-2">Businesses</h2>
                <ul>
                    <li>
                        <a href="#" class="sidebar-link block py-2 px-4 rounded mb-1 text-gray-700" data-page="toplink-dashboard">
                            <i class="fas fa-building mr-2"></i>TOPLINK SOLUTIONS
                        </a>
                    </li>
                    <li>
                        <a href="#" class="sidebar-link block py-2 px-4 rounded mb-1 text-gray-700" data-page="benick-dashboard">
                            <i class="fas fa-store mr-2"></i>BENICK ACCESSORIES
                        </a>
                    </li>
                    <li>
                        <a href="#" class="sidebar-link block py-2 px-4 rounded mb-1 text-gray-700" data-page="kim-dashboard">
                            <i class="fas fa-seedling mr-2"></i>KIM MELONS
                        </a>
                    </li>
                </ul>
                
                <h2 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mt-6 mb-2">Tools</h2>
                <ul>
                    <li>
                        <a href="#" class="sidebar-link block py-2 px-4 rounded mb-1 text-gray-700" data-page="suppliers">
                            <i class="fas fa-truck mr-2"></i>All Suppliers
                        </a>
                    </li>
                    <li>
                        <a href="#" class="sidebar-link block py-2 px-4 rounded mb-1 text-gray-700" data-page="reports">
                            <i class="fas fa-chart-bar mr-2"></i>Reports
                        </a>
                    </li>
                </ul>
                
                <h2 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mt-6 mb-2">Account</h2>
                <ul>
                    <li>
                        <a href="#" class="sidebar-link block py-2 px-4 rounded mb-1 text-gray-700" data-page="profile">
                            <i class="fas fa-user mr-2"></i>Profile
                        </a>
                    </li>
                    <li>
                        <a href="#" id="logout-btn" class="block py-2 px-4 rounded mb-1 text-gray-700 hover:bg-red-50 hover:text-red-600">
                            <i class="fas fa-sign-out-alt mr-2"></i>Logout
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Main Content -->
        <div class="ml-64 p-6">
            <div id="page-content" class="fade-in">
                <!-- Main Dashboard will be loaded here by default -->
            </div>
        </div>
    </div>

    <script>
        // Initialize Supabase - REPLACE WITH YOUR ACTUAL SUPABASE CREDENTIALS
        const supabaseUrl = 'https://getpshffamiwdgdcpskm.supabase.co';
        const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdldHBzaGZmYW1pd2RnZGNwc2ttIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk0ODc2MDksImV4cCI6MjA3NTA2MzYwOX0.X6jCmOMC9TsVCNMshBIq3AAgnudKgs5iff9Ao3FugTw';
        
        const supabase = window.supabase.createClient(supabaseUrl, supabaseAnonKey);

        // Sample data for demonstration (fallback only)
        const demoBusinessData = {
            'toplink': {
                name: 'TOPLINK SOLUTIONS',
                color: 'blue',
                income: 125430,
                profit: 45200,
                losses: 8200,
                dailyComparison: '+5.2%',
                weeklyComparison: '+12.7%',
                monthlyComparison: '+18.3%',
                suppliers: [
                    { id: 1, name: 'Global Tech Inc', contact: 'john@globaltech.com', rating: 4.5, phone: '+1-555-0101' },
                    { id: 2, name: 'Component World', contact: 'sarah@compworld.com', rating: 4.2, phone: '+1-555-0102' },
                    { id: 3, name: 'Digital Solutions', contact: 'mike@digisolutions.com', rating: 4.7, phone: '+1-555-0103' },
                    { id: 4, name: 'Tech Partners LLC', contact: 'anna@techpartners.com', rating: 4.4, phone: '+1-555-0104' }
                ],
                monthlyData: [12000, 19000, 15000, 25000, 22000, 30000, 28000, 32000, 29000, 35000, 33000, 38000],
                previousYearData: [10000, 15000, 13000, 20000, 18000, 25000, 23000, 27000, 25000, 30000, 28000, 32000]
            },
            'benick': {
                name: 'BENICK ACCESSORIES',
                color: 'green',
                income: 85670,
                profit: 32150,
                losses: 5300,
                dailyComparison: '+3.8%',
                weeklyComparison: '+8.5%',
                monthlyComparison: '+14.2%',
                suppliers: [
                    { id: 1, name: 'Fashion Trends Ltd', contact: 'lisa@fashiontrends.com', rating: 4.3, phone: '+1-555-0201' },
                    { id: 2, name: 'Style Makers', contact: 'david@stylemakers.com', rating: 4.0, phone: '+1-555-0202' },
                    { id: 3, name: 'Accessory World', contact: 'emma@accessoryworld.com', rating: 4.6, phone: '+1-555-0203' },
                    { id: 4, name: 'Trendsetters Inc', contact: 'james@trendsetters.com', rating: 4.1, phone: '+1-555-0204' }
                ],
                monthlyData: [8000, 12000, 10000, 15000, 18000, 20000, 19000, 22000, 21000, 24000, 23000, 25000],
                previousYearData: [7000, 10000, 9000, 13000, 15000, 18000, 17000, 19000, 18000, 21000, 20000, 22000]
            },
            'kim': {
                name: 'KIM MELONS',
                color: 'purple',
                income: 65240,
                profit: 28450,
                losses: 4200,
                dailyComparison: '+7.1%',
                weeklyComparison: '+15.3%',
                monthlyComparison: '+22.6%',
                suppliers: [
                    { id: 1, name: 'Fresh Farms Co', contact: 'tom@freshfarms.com', rating: 4.8, phone: '+1-555-0301' },
                    { id: 2, name: 'Organic Harvest', contact: 'susan@organicharvest.com', rating: 4.4, phone: '+1-555-0302' },
                    { id: 3, name: 'Local Growers', contact: 'robert@localgrowers.com', rating: 4.1, phone: '+1-555-0303' },
                    { id: 4, name: 'Farm Fresh Ltd', contact: 'maria@farmfresh.com', rating: 4.5, phone: '+1-555-0304' }
                ],
                monthlyData: [6000, 9000, 11000, 13000, 15000, 18000, 17000, 19000, 20000, 22000, 21000, 23000],
                previousYearData: [5000, 7000, 9000, 11000, 13000, 15000, 14000, 16000, 17000, 19000, 18000, 20000]
            }
        };

        // DOM Elements
        const loginScreen = document.getElementById('login-screen');
        const app = document.getElementById('app');
        const loadingSpinner = document.getElementById('loading-spinner');
        const authMessage = document.getElementById('auth-message');
        const userWelcome = document.getElementById('user-welcome');
        
        // Auth elements
        const loginTab = document.getElementById('login-tab');
        const signupTab = document.getElementById('signup-tab');
        const loginForm = document.getElementById('login-form');
        const signupForm = document.getElementById('signup-form');
        const forgotPasswordForm = document.getElementById('forgot-password-form');
        const forgotPasswordLink = document.getElementById('forgot-password-link');
        const backToLogin = document.getElementById('back-to-login');
        
        // Modal elements
        const addRecordModal = document.getElementById('add-record-modal');
        const addSupplierModal = document.getElementById('add-supplier-modal');
        const recordForm = document.getElementById('record-form');
        const supplierForm = document.getElementById('supplier-form');
        const cancelRecord = document.getElementById('cancel-record');
        const cancelSupplier = document.getElementById('cancel-supplier');
        
        const logoutBtn = document.getElementById('logout-btn');
        const pageContent = document.getElementById('page-content');
        const sidebarLinks = document.querySelectorAll('.sidebar-link');

        // Auth state management
        let currentUser = null;
        let businessData = {};

        // Show/hide forms
        function showForm(formToShow) {
            document.querySelectorAll('.auth-form').forEach(form => {
                form.classList.remove('active-form');
                form.classList.add('hidden-form');
            });
            
            formToShow.classList.remove('hidden-form');
            formToShow.classList.add('active-form');
            
            loginTab.classList.remove('bg-blue-500', 'text-white');
            signupTab.classList.remove('bg-blue-500', 'text-white');
            
            if (formToShow === loginForm || formToShow === forgotPasswordForm) {
                loginTab.classList.add('bg-blue-500', 'text-white');
                signupTab.classList.add('text-gray-600', 'hover:text-gray-800');
            } else {
                signupTab.classList.add('bg-blue-500', 'text-white');
                loginTab.classList.add('text-gray-600', 'hover:text-gray-800');
            }
            
            hideMessage();
        }

        // Modal functions
        function showModal(modal) {
            modal.classList.remove('hidden');
        }

        function hideModal(modal) {
            modal.classList.add('hidden');
        }

        // Show message
        function showMessage(message, type = 'error') {
            authMessage.textContent = message;
            authMessage.className = `mt-4 p-3 rounded ${type === 'error' ? 'bg-red-100 text-red-700' : 'bg-green-100 text-green-700'}`;
            authMessage.classList.remove('hidden');
        }

        function hideMessage() {
            authMessage.classList.add('hidden');
        }

        function showLoading() {
            loadingSpinner.classList.remove('hidden');
        }

        function hideLoading() {
            loadingSpinner.classList.add('hidden');
        }

        // Auth event listeners
        loginTab.addEventListener('click', () => showForm(loginForm));
        signupTab.addEventListener('click', () => showForm(signupForm));
        forgotPasswordLink.addEventListener('click', (e) => {
            e.preventDefault();
            showForm(forgotPasswordForm);
        });
        backToLogin.addEventListener('click', () => showForm(loginForm));

        // Modal event listeners
        cancelRecord.addEventListener('click', () => hideModal(addRecordModal));
        cancelSupplier.addEventListener('click', () => hideModal(addSupplierModal));

        // Record form handler
        recordForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const business = document.getElementById('record-business').value;
            const type = document.getElementById('record-type').value;
            const amount = document.getElementById('record-amount').value;
            const description = document.getElementById('record-description').value;
            
            // Save to Supabase
            try {
                const { data, error } = await supabase
                    .from('records')
                    .insert([
                        { 
                            business: business, 
                            type: type, 
                            amount: parseFloat(amount), 
                            description: description,
                            user_id: currentUser?.id || 'demo-user'
                        }
                    ]);
                
                if (error) throw error;
                
                alert(`Record added successfully!\nBusiness: ${businessData[business].name}\nType: ${type}\nAmount: $${amount}\nDescription: ${description}`);
                
                hideModal(addRecordModal);
                recordForm.reset();
                
                // Refresh data after adding record
                await fetchBusinessData();
                loadPage('main-dashboard');
            } catch (error) {
                console.error('Error adding record:', error);
                alert('Error adding record. Please try again.');
            }
        });

        // Supplier form handler
        supplierForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const business = document.getElementById('supplier-business').value;
            const name = document.getElementById('supplier-name').value;
            const email = document.getElementById('supplier-email').value;
            const phone = document.getElementById('supplier-phone').value;
            
            // Save to Supabase
            try {
                const { data, error } = await supabase
                    .from('suppliers')
                    .insert([
                        { 
                            business: business, 
                            name: name, 
                            contact: email, 
                            phone: phone,
                            user_id: currentUser?.id || 'demo-user'
                        }
                    ]);
                
                if (error) throw error;
                
                alert(`Supplier added successfully!\nBusiness: ${businessData[business].name}\nSupplier: ${name}\nEmail: ${email}\nPhone: ${phone}`);
                
                hideModal(addSupplierModal);
                supplierForm.reset();
                
                // Refresh data after adding supplier
                await fetchBusinessData();
                loadPage('suppliers');
            } catch (error) {
                console.error('Error adding supplier:', error);
                alert('Error adding supplier. Please try again.');
            }
        });

        // Login handler
        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            // Demo login - no Supabase required
            if (email && password) {
                showLoading();
                setTimeout(async () => {
                    currentUser = { email: email, id: 'demo-user' };
                    showMessage('Login successful!', 'success');
                    setTimeout(async () => {
                        await fetchBusinessData();
                        loginScreen.classList.add('hidden');
                        app.classList.remove('hidden');
                        userWelcome.textContent = `Welcome back, ${currentUser.email}!`;
                        loadPage('main-dashboard');
                        hideLoading();
                    }, 1000);
                }, 1500);
            } else {
                showMessage('Please enter both email and password');
            }
        });

        // Sign up handler
        signupForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const name = document.getElementById('signup-name').value;
            const email = document.getElementById('signup-email').value;
            const password = document.getElementById('signup-password').value;
            
            showLoading();
            setTimeout(() => {
                showMessage('Account created successfully! You can now login.', 'success');
                setTimeout(() => {
                    showForm(loginForm);
                    document.getElementById('login-email').value = email;
                    hideLoading();
                }, 2000);
            }, 1500);
        });

        // Forgot password handler
        forgotPasswordForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('reset-email').value;
            
            showLoading();
            setTimeout(() => {
                showMessage('Password reset link sent to your email!', 'success');
                setTimeout(() => {
                    showForm(loginForm);
                    hideLoading();
                }, 2000);
            }, 1500);
        });

        // Logout handler
        logoutBtn.addEventListener('click', async () => {
            currentUser = null;
            app.classList.add('hidden');
            loginScreen.classList.remove('hidden');
            showForm(loginForm);
            document.getElementById('login-email').value = '';
            document.getElementById('login-password').value = '';
            hideMessage();
        });

        // Fetch business data from Supabase
        async function fetchBusinessData() {
            try {
                // Fetch records from Supabase
                const { data: records, error: recordsError } = await supabase
                    .from('records')
                    .select('*')
                    .eq('user_id', currentUser?.id || 'demo-user');
                
                if (recordsError) throw recordsError;
                
                // Fetch suppliers from Supabase
                const { data: suppliers, error: suppliersError } = await supabase
                    .from('suppliers')
                    .select('*')
                    .eq('user_id', currentUser?.id || 'demo-user');
                
                if (suppliersError) throw suppliersError;
                
                // Process data if we have records from Supabase
                if (records && records.length > 0) {
                    // Initialize business data structure
                    businessData = {
                        'toplink': { ...demoBusinessData.toplink, income: 0, profit: 0, losses: 0, suppliers: [] },
                        'benick': { ...demoBusinessData.benick, income: 0, profit: 0, losses: 0, suppliers: [] },
                        'kim': { ...demoBusinessData.kim, income: 0, profit: 0, losses: 0, suppliers: [] }
                    };
                    
                    // Calculate income, profit, and losses from records
                    records.forEach(record => {
                        if (record.type === 'income') {
                            businessData[record.business].income += record.amount;
                            businessData[record.business].profit += record.amount;
                        } else if (record.type === 'expense') {
                            businessData[record.business].losses += record.amount;
                            businessData[record.business].profit -= record.amount;
                        } else if (record.type === 'supplier') {
                            businessData[record.business].losses += record.amount;
                            businessData[record.business].profit -= record.amount;
                        }
                    });
                    
                    // Add suppliers from Supabase
                    if (suppliers && suppliers.length > 0) {
                        suppliers.forEach(supplier => {
                            businessData[supplier.business].suppliers.push({
                                id: supplier.id,
                                name: supplier.name,
                                contact: supplier.contact,
                                phone: supplier.phone,
                                rating: 4.0 // Default rating
                            });
                        });
                    }
                } else {
                    // Use demo data if no records in Supabase
                    businessData = { ...demoBusinessData };
                    console.log('Using demo data as no Supabase records found');
                }
            } catch (error) {
                console.error('Error fetching data from Supabase:', error);
                // Fallback to demo data
                businessData = { ...demoBusinessData };
                console.log('Using demo data due to Supabase error');
            }
        }

        // Check for existing session on page load
        async function checkAuth() {
            // For demo, auto-login with demo credentials
            const demoEmail = 'demo@example.com';
            currentUser = { email: demoEmail, id: 'demo-user' };
            
            // Fetch data from Supabase
            await fetchBusinessData();
            
            loginScreen.classList.add('hidden');
            app.classList.remove('hidden');
            userWelcome.textContent = `Welcome back, ${currentUser.email}!`;
            loadPage('main-dashboard');
        }

        // Initialize auth check
        checkAuth();

        // Sidebar navigation
        sidebarLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const page = link.getAttribute('data-page');
                
                sidebarLinks.forEach(l => l.classList.remove('active'));
                link.classList.add('active');
                
                loadPage(page);
            });
        });

        // Page loading function
        function loadPage(page) {
            pageContent.innerHTML = '';
            pageContent.classList.remove('fade-in');
            
            setTimeout(() => {
                pageContent.classList.add('fade-in');
                
                switch(page) {
                    case 'main-dashboard':
                        loadMainDashboard();
                        break;
                    case 'toplink-dashboard':
                        loadBusinessDashboard('toplink');
                        break;
                    case 'benick-dashboard':
                        loadBusinessDashboard('benick');
                        break;
                    case 'kim-dashboard':
                        loadBusinessDashboard('kim');
                        break;
                    case 'suppliers':
                        loadAllSuppliers();
                        break;
                    case 'reports':
                        loadReportsPage();
                        break;
                    case 'profile':
                        loadProfilePage();
                        break;
                    default:
                        loadMainDashboard();
                }
            }, 10);
        }

        // Load main dashboard
        function loadMainDashboard() {
            pageContent.innerHTML = `
                <div class="mb-8">
                    <h1 class="text-3xl font-bold text-gray-800">Overall Business Dashboard</h1>
                    <p class="text-gray-600">Summary of all your businesses</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    ${generateBusinessCard('toplink')}
                    ${generateBusinessCard('benick')}
                    ${generateBusinessCard('kim')}
                </div>
                
                <div class="bg-white rounded-xl shadow-md p-6 mb-8">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">Financial Overview</h2>
                    <div class="h-80">
                        <canvas id="overviewChart"></canvas>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h2 class="text-xl font-bold text-gray-800 mb-4">Recent Activity</h2>
                        <ul class="space-y-4">
                            <li class="flex items-center">
                                <div class="bg-blue-100 p-2 rounded-full mr-3">
                                    <i class="fas fa-money-bill-wave text-blue-500"></i>
                                </div>
                                <div>
                                    <p class="font-medium">Payment received from Client A</p>
                                    <p class="text-sm text-gray-500">2 hours ago • TOPLINK SOLUTIONS</p>
                                </div>
                            </li>
                            <li class="flex items-center">
                                <div class="bg-green-100 p-2 rounded-full mr-3">
                                    <i class="fas fa-shipping-fast text-green-500"></i>
                                </div>
                                <div>
                                    <p class="font-medium">New inventory arrived</p>
                                    <p class="text-sm text-gray-500">5 hours ago • BENICK ACCESSORIES</p>
                                </div>
                            </li>
                            <li class="flex items-center">
                                <div class="bg-purple-100 p-2 rounded-full mr-3">
                                    <i class="fas fa-seedling text-purple-500"></i>
                                </div>
                                <div>
                                    <p class="font-medium">Harvest completed for season</p>
                                    <p class="text-sm text-gray-500">1 day ago • KIM MELONS</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h2 class="text-xl font-bold text-gray-800 mb-4">Quick Actions</h2>
                        <div class="grid grid-cols-2 gap-4">
                            <button class="quick-action-btn bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-lg transition duration-200 flex flex-col items-center justify-center" data-action="add-record">
                                <i class="fas fa-plus text-xl mb-2"></i>
                                <span>Add Record</span>
                            </button>
                            <button class="quick-action-btn bg-green-500 hover:bg-green-600 text-white py-3 rounded-lg transition duration-200 flex flex-col items-center justify-center" data-action="generate-report">
                                <i class="fas fa-chart-bar text-xl mb-2"></i>
                                <span>Generate Report</span>
                            </button>
                            <button class="quick-action-btn bg-purple-500 hover:bg-purple-600 text-white py-3 rounded-lg transition duration-200 flex flex-col items-center justify-center" data-action="manage-suppliers">
                                <i class="fas fa-users text-xl mb-2"></i>
                                <span>Manage Suppliers</span>
                            </button>
                            <button class="quick-action-btn bg-indigo-500 hover:bg-indigo-600 text-white py-3 rounded-lg transition duration-200 flex flex-col items-center justify-center" data-action="settings">
                                <i class="fas fa-cog text-xl mb-2"></i>
                                <span>Settings</span>
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            // Add event listeners to business buttons
            document.querySelectorAll('.view-business-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const business = btn.getAttribute('data-business');
                    loadBusinessDashboard(business);
                    
                    sidebarLinks.forEach(l => l.classList.remove('active'));
                    document.querySelector(`[data-page="${business}-dashboard"]`).classList.add('active');
                });
            });

            // Add event listeners to quick action buttons
            document.querySelectorAll('.quick-action-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const action = btn.getAttribute('data-action');
                    handleQuickAction(action);
                });
            });
            
            renderOverviewChart();
        }

        // Handle quick actions
        function handleQuickAction(action) {
            switch(action) {
                case 'add-record':
                    showModal(addRecordModal);
                    break;
                case 'generate-report':
                    alert('Report generation feature would be implemented here!');
                    break;
                case 'manage-suppliers':
                    loadPage('suppliers');
                    sidebarLinks.forEach(l => l.classList.remove('active'));
                    document.querySelector('[data-page="suppliers"]').classList.add('active');
                    break;
                case 'settings':
                    alert('Settings panel would open here!');
                    break;
            }
        }

        // Generate business card HTML
        function generateBusinessCard(business) {
            const biz = businessData[business];
            return `
                <div class="bg-white rounded-xl shadow-md p-6 card-hover">
                    <div class="flex justify-between items-start">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-700">${biz.name}</h3>
                            <p class="text-2xl font-bold text-${biz.color}-600 mt-2">$${biz.income.toLocaleString()}</p>
                            <p class="text-green-500 mt-1">Profit: $${biz.profit.toLocaleString()}</p>
                            <p class="text-red-500 mt-1">Losses: $${biz.losses.toLocaleString()}</p>
                            <div class="mt-3 flex space-x-2">
                                <span class="bg-${biz.color}-100 text-${biz.color}-800 text-xs px-2 py-1 rounded">Daily: ${biz.dailyComparison}</span>
                                <span class="bg-${biz.color}-100 text-${biz.color}-800 text-xs px-2 py-1 rounded">Weekly: ${biz.weeklyComparison}</span>
                            </div>
                        </div>
                        <div class="bg-${biz.color}-100 p-3 rounded-full">
                            <i class="fas fa-${business === 'toplink' ? 'building' : business === 'benick' ? 'store' : 'seedling'} text-${biz.color}-500 text-xl"></i>
                        </div>
                    </div>
                    <button class="mt-4 w-full bg-${biz.color}-500 hover:bg-${biz.color}-600 text-white py-2 rounded-lg transition duration-200 view-business-btn" data-business="${business}">
                        View Details
                    </button>
                </div>
            `;
        }

        // Load business dashboard
        function loadBusinessDashboard(business) {
            const biz = businessData[business];
            const colorClass = `text-${biz.color}-600`;
            const bgColorClass = `bg-${biz.color}-100`;
            
            pageContent.innerHTML = `
                <div class="mb-8">
                    <div class="flex justify-between items-center">
                        <div>
                            <h1 class="text-3xl font-bold text-gray-800">${biz.name} Dashboard</h1>
                            <p class="text-gray-600">Detailed overview and management</p>
                        </div>
                        <div class="flex space-x-4">
                            <button class="export-btn bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 py-2 px-4 rounded-lg transition duration-200">
                                <i class="fas fa-download mr-2"></i>Export
                            </button>
                            <button class="add-record-btn bg-${biz.color}-500 hover:bg-${biz.color}-600 text-white py-2 px-4 rounded-lg transition duration-200">
                                <i class="fas fa-plus mr-2"></i>Add Record
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white rounded-xl shadow-md p-6 card-hover">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-gray-500">Total Income</p>
                                <p class="text-2xl font-bold ${colorClass}">$${biz.income.toLocaleString()}</p>
                            </div>
                            <div class="${bgColorClass} p-3 rounded-full">
                                <i class="fas fa-money-bill-wave ${colorClass} text-xl"></i>
                            </div>
                        </div>
                        <p class="text-green-500 text-sm mt-2"><i class="fas fa-arrow-up mr-1"></i> ${biz.monthlyComparison} from last year</p>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-md p-6 card-hover">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-gray-500">Net Profit</p>
                                <p class="text-2xl font-bold text-green-600">$${biz.profit.toLocaleString()}</p>
                            </div>
                            <div class="bg-green-100 p-3 rounded-full">
                                <i class="fas fa-chart-line text-green-500 text-xl"></i>
                            </div>
                        </div>
                        <p class="text-green-500 text-sm mt-2"><i class="fas fa-arrow-up mr-1"></i> ${biz.weeklyComparison} from last week</p>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-md p-6 card-hover">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-gray-500">Losses</p>
                                <p class="text-2xl font-bold text-red-600">$${biz.losses.toLocaleString()}</p>
                            </div>
                            <div class="bg-red-100 p-3 rounded-full">
                                <i class="fas fa-exclamation-triangle text-red-500 text-xl"></i>
                            </div>
                        </div>
                        <p class="text-red-500 text-sm mt-2"><i class="fas fa-arrow-up mr-1"></i> 3% from last month</p>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-md p-6 card-hover">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-gray-500">Suppliers</p>
                                <p class="text-2xl font-bold text-indigo-600">${biz.suppliers.length}</p>
                            </div>
                            <div class="bg-indigo-100 p-3 rounded-full">
                                <i class="fas fa-truck text-indigo-500 text-xl"></i>
                            </div>
                        </div>
                        <p class="text-gray-500 text-sm mt-2">Active suppliers</p>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h2 class="text-xl font-bold text-gray-800 mb-4">Financial Performance</h2>
                        <div class="h-80">
                            <canvas id="businessChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h2 class="text-xl font-bold text-gray-800 mb-4">Supplier List</h2>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead>
                                    <tr>
                                        <th class="px-4 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Supplier</th>
                                        <th class="px-4 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contact</th>
                                        <th class="px-4 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rating</th>
                                        <th class="px-4 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200">
                                    ${biz.suppliers.map(supplier => `
                                        <tr>
                                            <td class="px-4 py-3 whitespace-nowrap">
                                                <div class="font-medium text-gray-900">${supplier.name}</div>
                                                <div class="text-sm text-gray-500">${supplier.phone}</div>
                                            </td>
                                            <td class="px-4 py-3 whitespace-nowrap text-gray-500">${supplier.contact}</td>
                                            <td class="px-4 py-3 whitespace-nowrap">
                                                <div class="flex items-center">
                                                    <div class="text-yellow-400 mr-1">
                                                        ${'<i class="fas fa-star"></i>'.repeat(Math.floor(supplier.rating))}
                                                        ${supplier.rating % 1 !== 0 ? '<i class="fas fa-star-half-alt"></i>' : ''}
                                                    </div>
                                                    <span class="ml-1">${supplier.rating}</span>
                                                </div>
                                            </td>
                                            <td class="px-4 py-3 whitespace-nowrap text-sm font-medium">
                                                <button class="edit-supplier-btn text-${biz.color}-600 hover:text-${biz.color}-900 mr-3">Edit</button>
                                                <button class="delete-supplier-btn text-red-600 hover:text-red-900">Delete</button>
                                            </td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                        <button class="add-supplier-btn mt-4 bg-${biz.color}-500 hover:bg-${biz.color}-600 text-white py-2 px-4 rounded-lg transition duration-200">
                            <i class="fas fa-plus mr-2"></i>Add New Supplier
                        </button>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">Year-over-Year Comparison</h2>
                    <div class="flex space-x-4 mb-6">
                        <button class="comparison-btn bg-${biz.color}-500 text-white py-2 px-4 rounded-lg" data-period="daily">Daily</button>
                        <button class="comparison-btn bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 py-2 px-4 rounded-lg" data-period="weekly">Weekly</button>
                        <button class="comparison-btn bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 py-2 px-4 rounded-lg" data-period="monthly">Monthly</button>
                    </div>
                    <div class="h-80">
                        <canvas id="comparisonChart"></canvas>
                    </div>
                </div>
            `;
            
            // Add event listeners to buttons in business dashboard
            document.querySelector('.add-record-btn').addEventListener('click', () => {
                showModal(addRecordModal);
            });
            
            document.querySelector('.export-btn').addEventListener('click', () => {
                alert(`Exporting data for ${biz.name}...`);
            });
            
            document.querySelector('.add-supplier-btn').addEventListener('click', () => {
                showModal(addSupplierModal);
            });
            
            // Add event listeners to comparison buttons
            document.querySelectorAll('.comparison-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const period = btn.getAttribute('data-period');
                    alert(`Showing ${period} comparison for ${biz.name}`);
                    
                    // Update button states
                    document.querySelectorAll('.comparison-btn').forEach(b => {
                        b.classList.remove(`bg-${biz.color}-500`, 'text-white');
                        b.classList.add('bg-white', 'border', 'border-gray-300', 'text-gray-700');
                    });
                    btn.classList.add(`bg-${biz.color}-500`, 'text-white');
                    btn.classList.remove('bg-white', 'border', 'border-gray-300', 'text-gray-700');
                });
            });
            
            // Add event listeners to supplier action buttons
            document.querySelectorAll('.edit-supplier-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    alert('Edit supplier feature would open here!');
                });
            });
            
            document.querySelectorAll('.delete-supplier-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    if (confirm('Are you sure you want to delete this supplier?')) {
                        alert('Supplier deleted successfully!');
                    }
                });
            });
            
            renderBusinessChart(business);
            renderComparisonChart(business);
        }

        // Load all suppliers page
        function loadAllSuppliers() {
            // Combine all suppliers
            const allSuppliers = [
                ...businessData.toplink.suppliers.map(s => ({...s, business: 'TOPLINK SOLUTIONS', businessId: 'toplink'})),
                ...businessData.benick.suppliers.map(s => ({...s, business: 'BENICK ACCESSORIES', businessId: 'benick'})),
                ...businessData.kim.suppliers.map(s => ({...s, business: 'KIM MELONS', businessId: 'kim'}))
            ];
            
            pageContent.innerHTML = `
                <div class="mb-8">
                    <h1 class="text-3xl font-bold text-gray-800">All Suppliers</h1>
                    <p class="text-gray-600">Manage suppliers across all businesses</p>
                </div>
                
                <div class="bg-white rounded-xl shadow-md p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-bold text-gray-800">Supplier Directory</h2>
                        <button class="global-add-supplier-btn bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded-lg transition duration-200">
                            <i class="fas fa-plus mr-2"></i>Add New Supplier
                        </button>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead>
                                <tr>
                                    <th class="px-4 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Supplier</th>
                                    <th class="px-4 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Business</th>
                                    <th class="px-4 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contact</th>
                                    <th class="px-4 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rating</th>
                                    <th class="px-4 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                ${allSuppliers.map(supplier => `
                                    <tr>
                                        <td class="px-4 py-3 whitespace-nowrap">
                                            <div class="font-medium text-gray-900">${supplier.name}</div>
                                            <div class="text-sm text-gray-500">${supplier.phone}</div>
                                        </td>
                                        <td class="px-4 py-3 whitespace-nowrap">
                                            <span class="px-2 py-1 text-xs rounded-full 
                                                ${supplier.businessId === 'toplink' ? 'bg-blue-100 text-blue-800' : 
                                                  supplier.businessId === 'benick' ? 'bg-green-100 text-green-800' : 
                                                  'bg-purple-100 text-purple-800'}">
                                                ${supplier.business}
                                            </span>
                                        </td>
                                        <td class="px-4 py-3 whitespace-nowrap text-gray-500">${supplier.contact}</td>
                                        <td class="px-4 py-3 whitespace-nowrap">
                                            <div class="flex items-center">
                                                <div class="text-yellow-400 mr-1">
                                                    ${'<i class="fas fa-star"></i>'.repeat(Math.floor(supplier.rating))}
                                                    ${supplier.rating % 1 !== 0 ? '<i class="fas fa-star-half-alt"></i>' : ''}
                                                </div>
                                                <span class="ml-1">${supplier.rating}</span>
                                            </div>
                                        </td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm font-medium">
                                            <button class="edit-supplier-btn text-blue-600 hover:text-blue-900 mr-3">Edit</button>
                                            <button class="delete-supplier-btn text-red-600 hover:text-red-900">Delete</button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
            
            // Add event listeners
            document.querySelector('.global-add-supplier-btn').addEventListener('click', () => {
                showModal(addSupplierModal);
            });
            
            document.querySelectorAll('.edit-supplier-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    alert('Edit supplier feature would open here!');
                });
            });
            
            document.querySelectorAll('.delete-supplier-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    if (confirm('Are you sure you want to delete this supplier?')) {
                        alert('Supplier deleted successfully!');
                    }
                });
            });
        }

        // Load reports page
        function loadReportsPage() {
            pageContent.innerHTML = `
                <div class="mb-8">
                    <h1 class="text-3xl font-bold text-gray-800">Business Reports</h1>
                    <p class="text-gray-600">Generate and view detailed reports</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                    <div class="bg-white rounded-xl shadow-md p-6 card-hover">
                        <div class="flex justify-between items-start">
                            <div>
                                <h3 class="text-lg font-semibold text-gray-700">Profit & Loss</h3>
                                <p class="text-gray-500 mt-2">Monthly P&L statements</p>
                            </div>
                            <div class="bg-blue-100 p-3 rounded-full">
                                <i class="fas fa-file-invoice-dollar text-blue-500 text-xl"></i>
                            </div>
                        </div>
                        <button class="report-btn mt-4 w-full bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg transition duration-200" data-report="profit-loss">
                            Generate Report
                        </button>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-md p-6 card-hover">
                        <div class="flex justify-between items-start">
                            <div>
                                <h3 class="text-lg font-semibold text-gray-700">Supplier Performance</h3>
                                <p class="text-gray-500 mt-2">Vendor evaluation reports</p>
                            </div>
                            <div class="bg-green-100 p-3 rounded-full">
                                <i class="fas fa-chart-line text-green-500 text-xl"></i>
                            </div>
                        </div>
                        <button class="report-btn mt-4 w-full bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg transition duration-200" data-report="supplier-performance">
                            Generate Report
                        </button>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-md p-6 card-hover">
                        <div class="flex justify-between items-start">
                            <div>
                                <h3 class="text-lg font-semibold text-gray-700">Tax Preparation</h3>
                                <p class="text-gray-500 mt-2">Year-end tax documents</p>
                            </div>
                            <div class="bg-purple-100 p-3 rounded-full">
                                <i class="fas fa-receipt text-purple-500 text-xl"></i>
                            </div>
                        </div>
                        <button class="report-btn mt-4 w-full bg-purple-500 hover:bg-purple-600 text-white py-2 rounded-lg transition duration-200" data-report="tax">
                            Generate Report
                        </button>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">Recent Reports</h2>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between p-4 border rounded-lg">
                            <div>
                                <h4 class="font-semibold">Q3 Financial Summary</h4>
                                <p class="text-sm text-gray-500">Generated on October 15, 2023</p>
                            </div>
                            <button class="text-blue-500 hover:text-blue-700">Download</button>
                        </div>
                        <div class="flex items-center justify-between p-4 border rounded-lg">
                            <div>
                                <h4 class="font-semibold">Supplier Performance Q3</h4>
                                <p class="text-sm text-gray-500">Generated on October 10, 2023</p>
                            </div>
                            <button class="text-blue-500 hover:text-blue-700">Download</button>
                        </div>
                    </div>
                </div>
            `;
            
            // Add event listeners to report buttons
            document.querySelectorAll('.report-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const reportType = btn.getAttribute('data-report');
                    alert(`Generating ${reportType.replace('-', ' ')} report...`);
                });
            });
        }

        // Load profile page
        function loadProfilePage() {
            pageContent.innerHTML = `
                <div class="max-w-2xl mx-auto">
                    <div class="mb-8">
                        <h1 class="text-3xl font-bold text-gray-800">Account Profile</h1>
                        <p class="text-gray-600">Manage your account settings</p>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-md p-6 mb-6">
                        <h2 class="text-xl font-bold text-gray-800 mb-4">Personal Information</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-gray-700 text-sm font-bold mb-2" for="firstName">First Name</label>
                                <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="firstName" type="text" value="Stella">
                            </div>
                            <div>
                                <label class="block text-gray-700 text-sm font-bold mb-2" for="lastName">Last Name</label>
                                <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="lastName" type="text" value="Business">
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-gray-700 text-sm font-bold mb-2" for="email">Email</label>
                                <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="email" type="email" value="${currentUser?.email || 'stella@business.com'}">
                            </div>
                        </div>
                        <button class="mt-6 bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline save-profile-btn">
                            Save Changes
                        </button>
                    </div>
                    
                    <div class="bg-white rounded-xl shadow-md p-6">
                        <h2 class="text-xl font-bold text-gray-800 mb-4">Business Preferences</h2>
                        <div class="space-y-4">
                            <div class="flex items-center">
                                <input id="notifications" type="checkbox" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded" checked>
                                <label for="notifications" class="ml-2 block text-sm text-gray-700">Receive email notifications</label>
                            </div>
                            <div class="flex items-center">
                                <input id="reports" type="checkbox" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded" checked>
                                <label for="reports" class="ml-2 block text-sm text-gray-700">Weekly performance reports</label>
                            </div>
                            <div class="flex items-center">
                                <input id="updates" type="checkbox" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                <label for="updates" class="ml-2 block text-sm text-gray-700">Product updates and news</label>
                            </div>
                        </div>
                        <button class="mt-6 bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline save-preferences-btn">
                            Save Preferences
                        </button>
                    </div>
                </div>
            `;
            
            // Add event listeners for profile page
            document.querySelector('.save-profile-btn').addEventListener('click', () => {
                alert('Profile updated successfully!');
            });
            
            document.querySelector('.save-preferences-btn').addEventListener('click', () => {
                alert('Preferences saved successfully!');
            });
        }

        // Chart rendering functions (simplified for demo)
        function renderOverviewChart() {
            const ctx = document.getElementById('overviewChart');
            if (ctx) {
                // Chart implementation would go here
            }
        }

        function renderBusinessChart(business) {
            const ctx = document.getElementById('businessChart');
            if (ctx) {
                // Chart implementation would go here
            }
        }

        function renderComparisonChart(business) {
            const ctx = document.getElementById('comparisonChart');
            if (ctx) {
                // Chart implementation would go here
            }
        }
    </script>
</body>
</html>
